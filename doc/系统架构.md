# å²©çŸ³å›¾åƒåˆ†ç±»ç³»ç»Ÿ - ç³»ç»Ÿæ¶æ„è¯´æ˜

## ğŸ—ï¸ ç³»ç»Ÿæ€»ä½“æ¶æ„

### æ¶æ„è®¾è®¡ç†å¿µ
æœ¬ç³»ç»Ÿé‡‡ç”¨**åˆ†å±‚æ¨¡å—åŒ–æ¶æ„**ï¼Œéµå¾ª**å•ä¸€èŒè´£åŸåˆ™**å’Œ**å¼€é—­åŸåˆ™**ï¼Œç¡®ä¿ç³»ç»Ÿçš„**å¯ç»´æŠ¤æ€§**ã€**å¯æ‰©å±•æ€§**å’Œ**é«˜æ€§èƒ½**ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å²©çŸ³å›¾åƒåˆ†ç±»ç³»ç»Ÿæ¶æ„                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¡¨ç¤ºå±‚ (UI)    â”‚    â”‚  ä¸šåŠ¡å±‚ (Logic) â”‚    â”‚  æ•°æ®å±‚ (Data)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    main.py      â”‚    â”‚   trainer.py    â”‚    â”‚ data_loader.py  â”‚
â”‚  (ç”¨æˆ·æ¥å£)      â”‚    â”‚   models.py     â”‚    â”‚   Rock Data/    â”‚
â”‚  (å‚æ•°è§£æ)      â”‚    â”‚  ensemble.py    â”‚    â”‚   (æ•°æ®é›†)      â”‚
â”‚  (æµç¨‹æ§åˆ¶)      â”‚    â”‚   (æ ¸å¿ƒé€»è¾‘)     â”‚    â”‚   (æ•°æ®å¤„ç†)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   config.py     â”‚
                    â”‚   utils.py      â”‚
                    â”‚   (é…ç½®&å·¥å…·)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶æ¶æ„

### 1. é…ç½®ç®¡ç†å±‚ (Configuration Layer)

```python
# config.py - é…ç½®ä¸­å¿ƒ
class Config:
    """ç»Ÿä¸€é…ç½®ç®¡ç†"""
    # æ•°æ®é…ç½®
    DATA_CONFIG = {
        'image_size': 224,
        'batch_size': 32,
        'num_classes': 9
    }
    
    # æ¨¡å‹é…ç½®
    MODEL_CONFIG = {
        'type': 'resnet50',
        'pretrained': True,
        'dropout_rate': 0.5
    }
    
    # è®­ç»ƒé…ç½®
    TRAINING_CONFIG = {
        'epochs': 100,
        'learning_rate': 0.001,
        'optimizer': 'adamw'
    }
```

**è®¾è®¡ç‰¹ç‚¹**:
- ğŸ¯ **é›†ä¸­ç®¡ç†**: æ‰€æœ‰é…ç½®å‚æ•°ç»Ÿä¸€ç®¡ç†
- ğŸ”§ **æ˜“äºä¿®æ”¹**: ä¿®æ”¹é…ç½®æ— éœ€æ”¹åŠ¨ä¸šåŠ¡ä»£ç 
- ğŸ“ **ç±»å‹å®‰å…¨**: æ˜ç¡®çš„å‚æ•°ç±»å‹å’Œé»˜è®¤å€¼
- ğŸ”„ **åŠ¨æ€æ›´æ–°**: æ”¯æŒè¿è¡Œæ—¶å‚æ•°è°ƒæ•´

### 2. æ•°æ®å¤„ç†å±‚ (Data Processing Layer)

```python
# æ•°æ®æµæ°´çº¿æ¶æ„
åŸå§‹å›¾åƒ â†’ é¢„å¤„ç† â†’ æ•°æ®å¢å¼º â†’ æ‰¹é‡åŠ è½½ â†’ æ¨¡å‹è¾“å…¥
    â”‚         â”‚         â”‚         â”‚         â”‚
    â–¼         â–¼         â–¼         â–¼         â–¼
  JPGæ–‡ä»¶   å°ºå¯¸è°ƒæ•´   æ—‹è½¬ç¿»è½¬   DataLoader  Tensor
  å¤šç§å°ºå¯¸   224x224   é¢œè‰²å˜æ¢   æ‰¹æ¬¡ç»„ç»‡   æ ‡å‡†åŒ–
```

**æ ¸å¿ƒç»„ä»¶**:
```python
class DataManager:
    """æ•°æ®ç®¡ç†å™¨"""
    def __init__(self, config):
        self.config = config
        self.train_transform = self._build_train_transform()
        self.test_transform = self._build_test_transform()
    
    def _build_train_transform(self):
        """æ„å»ºè®­ç»ƒæ•°æ®å˜æ¢æµæ°´çº¿"""
        return transforms.Compose([
            transforms.Resize((224, 224)),
            transforms.RandomHorizontalFlip(0.5),
            transforms.RandomRotation(30),
            transforms.ColorJitter(0.2, 0.2, 0.2, 0.1),
            transforms.ToTensor(),
            transforms.Normalize([0.485, 0.456, 0.406], 
                               [0.229, 0.224, 0.225])
        ])
    
    def get_data_loaders(self):
        """è·å–æ•°æ®åŠ è½½å™¨"""
        # åˆ›å»ºæ•°æ®é›†å’ŒåŠ è½½å™¨
        pass
```

**æ¶æ„ä¼˜åŠ¿**:
- âš¡ **é«˜æ•ˆæµæ°´çº¿**: å¤šè¿›ç¨‹å¹¶è¡Œæ•°æ®å¤„ç†
- ğŸ¨ **æ™ºèƒ½å¢å¼º**: è‡ªé€‚åº”æ•°æ®å¢å¼ºç­–ç•¥
- ğŸ’¾ **å†…å­˜ä¼˜åŒ–**: æŒ‰éœ€åŠ è½½ï¼Œå‡å°‘å†…å­˜å ç”¨
- ğŸ”„ **å¯æ‰©å±•æ€§**: æ˜“äºæ·»åŠ æ–°çš„æ•°æ®å˜æ¢

### 3. æ¨¡å‹å®šä¹‰å±‚ (Model Definition Layer)

```python
# æ¨¡å‹å·¥å‚æ¨¡å¼
class ModelFactory:
    """æ¨¡å‹å·¥å‚"""
    
    @staticmethod
    def create_model(model_type, num_classes, pretrained=True):
        """åˆ›å»ºæ¨¡å‹å®ä¾‹"""
        if model_type == 'resnet50':
            return ResNetModel('resnet50', num_classes, pretrained)
        elif model_type == 'efficientnet_b0':
            return EfficientNetModel('efficientnet_b0', num_classes, pretrained)
        else:
            raise ValueError(f"Unsupported model: {model_type}")

# æ¨¡å‹ç»§æ‰¿ä½“ç³»
class BaseModel(nn.Module):
    """åŸºç¡€æ¨¡å‹ç±»"""
    def __init__(self, num_classes):
        super().__init__()
        self.num_classes = num_classes
    
    def forward(self, x):
        raise NotImplementedError
    
    def get_feature_dim(self):
        raise NotImplementedError

class ResNetModel(BaseModel):
    """ResNetæ¨¡å‹å®ç°"""
    def __init__(self, model_name, num_classes, pretrained=True):
        super().__init__(num_classes)
        self.backbone = self._build_backbone(model_name, pretrained)
        self.classifier = self._build_classifier()
    
    def _build_backbone(self, model_name, pretrained):
        """æ„å»ºéª¨å¹²ç½‘ç»œ"""
        pass
    
    def _build_classifier(self):
        """æ„å»ºåˆ†ç±»å™¨"""
        pass
```

**è®¾è®¡æ¨¡å¼**:
- ğŸ­ **å·¥å‚æ¨¡å¼**: ç»Ÿä¸€çš„æ¨¡å‹åˆ›å»ºæ¥å£
- ğŸ§¬ **ç»§æ‰¿ä½“ç³»**: æ¸…æ™°çš„æ¨¡å‹å±‚æ¬¡ç»“æ„
- ğŸ”Œ **æ’ä»¶æ¶æ„**: æ˜“äºæ·»åŠ æ–°æ¨¡å‹
- ğŸ¯ **ç­–ç•¥æ¨¡å¼**: ä¸åŒçš„æ¨¡å‹ç­–ç•¥

### 4. è®­ç»ƒæ§åˆ¶å±‚ (Training Control Layer)

```python
# è®­ç»ƒå™¨æ¶æ„
class Trainer:
    """è®­ç»ƒæ§åˆ¶å™¨"""
    
    def __init__(self, model, data_loaders, config):
        self.model = model
        self.train_loader, self.valid_loader, self.test_loader = data_loaders
        self.config = config
        
        # åˆå§‹åŒ–è®­ç»ƒç»„ä»¶
        self.optimizer = self._build_optimizer()
        self.scheduler = self._build_scheduler()
        self.criterion = self._build_criterion()
        self.early_stopping = self._build_early_stopping()
    
    def train(self):
        """ä¸»è®­ç»ƒå¾ªç¯"""
        for epoch in range(self.config.EPOCHS):
            # è®­ç»ƒé˜¶æ®µ
            train_metrics = self.train_epoch()
            
            # éªŒè¯é˜¶æ®µ
            valid_metrics = self.validate_epoch()
            
            # å­¦ä¹ ç‡è°ƒåº¦
            self.scheduler.step()
            
            # æ—©åœæ£€æŸ¥
            if self.early_stopping(valid_metrics['loss'], self.model):
                break
        
        # æµ‹è¯•è¯„ä¼°
        test_metrics = self.test()
        return test_metrics
```

**æ§åˆ¶æµç¨‹**:
```
å¼€å§‹è®­ç»ƒ â†’ è®­ç»ƒå¾ªç¯ â†’ éªŒè¯è¯„ä¼° â†’ å­¦ä¹ ç‡è°ƒåº¦ â†’ æ—©åœæ£€æŸ¥ â†’ æ¨¡å‹ä¿å­˜ â†’ æµ‹è¯•è¯„ä¼°
    â†“         â†“         â†“         â†“         â†“         â†“         â†“
  åˆå§‹åŒ–    å‰å‘ä¼ æ’­   è®¡ç®—æŒ‡æ ‡   æ›´æ–°LR    æ£€æŸ¥æ”¶æ•›   ä¿å­˜æƒé‡   æœ€ç»ˆè¯„ä¼°
  ç»„ä»¶      åå‘ä¼ æ’­   è®°å½•å†å²   è°ƒæ•´ç­–ç•¥   é˜²æ­¢è¿‡æ‹Ÿåˆ  æœ€ä½³æ¨¡å‹   ç”ŸæˆæŠ¥å‘Š
```

### 5. é›†æˆå­¦ä¹ å±‚ (Ensemble Learning Layer)

```python
# é›†æˆå­¦ä¹ æ¶æ„
class EnsembleManager:
    """é›†æˆå­¦ä¹ ç®¡ç†å™¨"""
    
    def __init__(self, model_configs, data_loaders, config):
        self.model_configs = model_configs
        self.data_loaders = data_loaders
        self.config = config
        self.models = {}
        self.trainers = {}
    
    def train_ensemble(self):
        """è®­ç»ƒé›†æˆæ¨¡å‹"""
        # 1. è®­ç»ƒå„ä¸ªåŸºæ¨¡å‹
        for model_config in self.model_configs:
            model = self._create_model(model_config)
            trainer = Trainer(model, self.data_loaders, self.config)
            trainer.train()
            self.models[model_config['name']] = model
            self.trainers[model_config['name']] = trainer
        
        # 2. é›†æˆé¢„æµ‹
        ensemble_predictions = self._ensemble_predict()
        return ensemble_predictions
    
    def _ensemble_predict(self):
        """é›†æˆé¢„æµ‹"""
        # è½¯æŠ•ç¥¨é›†æˆ
        all_predictions = []
        for model in self.models.values():
            predictions = self._predict_with_model(model)
            all_predictions.append(predictions)
        
        # å¹³å‡æ¦‚ç‡
        ensemble_probs = np.mean(all_predictions, axis=0)
        return np.argmax(ensemble_probs, axis=1)
```

**é›†æˆç­–ç•¥**:
- ğŸ—³ï¸ **æŠ•ç¥¨æœºåˆ¶**: ç¡¬æŠ•ç¥¨å’Œè½¯æŠ•ç¥¨
- âš–ï¸ **æƒé‡åˆ†é…**: åŸºäºæ€§èƒ½çš„æ™ºèƒ½æƒé‡
- ğŸ¯ **å¤šæ ·æ€§**: ä¸åŒæ¶æ„çš„æ¨¡å‹ç»„åˆ
- ğŸ“Š **æ€§èƒ½è¯„ä¼°**: é›†æˆæ•ˆæœé‡åŒ–åˆ†æ

## ğŸ”„ æ•°æ®æµæ¶æ„

### æ•°æ®æµå‘å›¾
```
è¾“å…¥å›¾åƒ â†’ æ•°æ®é¢„å¤„ç† â†’ ç‰¹å¾æå– â†’ åˆ†ç±»å†³ç­– â†’ è¾“å‡ºç»“æœ
    â”‚         â”‚           â”‚         â”‚         â”‚
    â–¼         â–¼           â–¼         â–¼         â–¼
åŸå§‹JPG    æ•°æ®å¢å¼º     CNNç‰¹å¾    å…¨è¿æ¥å±‚   ç±»åˆ«æ¦‚ç‡
å¤šç§å°ºå¯¸    æ ‡å‡†åŒ–      ç‰¹å¾å›¾      Softmax   ç½®ä¿¡åº¦
ä¸åŒå…‰ç…§    æ‰¹é‡ç»„ç»‡     ç‰¹å¾å‘é‡    åˆ†ç±»å™¨    é¢„æµ‹æ ‡ç­¾
```

### è¯¦ç»†æ•°æ®æµç¨‹
1. **æ•°æ®è¾“å…¥**: åŸå§‹å²©çŸ³å›¾åƒ (JPGæ ¼å¼ï¼Œä¸åŒå°ºå¯¸)
2. **é¢„å¤„ç†**: å°ºå¯¸è°ƒæ•´ã€æ ¼å¼è½¬æ¢ã€æ•°æ®ç±»å‹è½¬æ¢
3. **æ•°æ®å¢å¼º**: æ—‹è½¬ã€ç¿»è½¬ã€é¢œè‰²å˜æ¢ã€éšæœºè£å‰ª
4. **æ‰¹é‡ç»„ç»‡**: ç»„ç»‡æˆè®­ç»ƒæ‰¹æ¬¡ï¼Œæ·»åŠ æ ‡ç­¾
5. **ç‰¹å¾æå–**: CNNéª¨å¹²ç½‘ç»œæå–æ·±å±‚ç‰¹å¾
6. **ç‰¹å¾èåˆ**: å…¨å±€å¹³å‡æ± åŒ–ã€ç‰¹å¾é™ç»´
7. **åˆ†ç±»å†³ç­–**: å…¨è¿æ¥å±‚ã€Softmaxæ¿€æ´»
8. **ç»“æœè¾“å‡º**: ç±»åˆ«æ¦‚ç‡ã€é¢„æµ‹æ ‡ç­¾ã€ç½®ä¿¡åº¦

## ğŸ§© æ¨¡å—äº¤äº’æ¶æ„

### æ¨¡å—ä¾èµ–å›¾
```
                    main.py (å…¥å£æ§åˆ¶)
                        â”‚
                        â–¼
                   config.py (é…ç½®ç®¡ç†)
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
  data_loader.py    models.py      trainer.py
  (æ•°æ®å¤„ç†)        (æ¨¡å‹å®šä¹‰)     (è®­ç»ƒæ§åˆ¶)
        â”‚               â”‚               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                  ensemble.py (é›†æˆå­¦ä¹ )
                        â”‚
                        â–¼
                   utils.py (å·¥å…·æ”¯æŒ)
```

### æ¥å£è®¾è®¡
```python
# æ ‡å‡†åŒ–æ¥å£è®¾è®¡
class DataInterface:
    """æ•°æ®æ¥å£"""
    def get_data_loaders(self) -> Tuple[DataLoader, DataLoader, DataLoader]:
        pass
    
    def get_class_names(self) -> List[str]:
        pass

class ModelInterface:
    """æ¨¡å‹æ¥å£"""
    def forward(self, x: torch.Tensor) -> torch.Tensor:
        pass
    
    def get_feature_dim(self) -> int:
        pass

class TrainerInterface:
    """è®­ç»ƒå™¨æ¥å£"""
    def train(self) -> Dict[str, float]:
        pass
    
    def evaluate(self) -> Dict[str, float]:
        pass
```

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–æ¶æ„

### è®¡ç®—ä¼˜åŒ–
```python
# GPUåŠ é€Ÿæ¶æ„
class GPUOptimizer:
    """GPUä¼˜åŒ–å™¨"""
    
    def __init__(self, model, config):
        self.model = model.to(config.DEVICE)
        self.config = config
        
        # æ··åˆç²¾åº¦è®­ç»ƒ
        if config.MIXED_PRECISION:
            self.scaler = torch.amp.GradScaler('cuda')
        
        # æ•°æ®å¹¶è¡Œ
        if torch.cuda.device_count() > 1:
            self.model = nn.DataParallel(self.model)
    
    def optimize_training(self, data, target):
        """ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹"""
        if self.config.MIXED_PRECISION:
            with torch.amp.autocast('cuda'):
                output = self.model(data)
                loss = self.criterion(output, target)
            
            self.scaler.scale(loss).backward()
            self.scaler.step(self.optimizer)
            self.scaler.update()
        else:
            output = self.model(data)
            loss = self.criterion(output, target)
            loss.backward()
            self.optimizer.step()
```

### å†…å­˜ä¼˜åŒ–
```python
# å†…å­˜ç®¡ç†æ¶æ„
class MemoryManager:
    """å†…å­˜ç®¡ç†å™¨"""
    
    def __init__(self, config):
        self.config = config
    
    def optimize_data_loading(self):
        """ä¼˜åŒ–æ•°æ®åŠ è½½"""
        return DataLoader(
            dataset,
            batch_size=self.config.BATCH_SIZE,
            num_workers=self.config.NUM_WORKERS,
            pin_memory=True,  # å›ºå®šå†…å­˜
            prefetch_factor=2,  # é¢„å–å› å­
            persistent_workers=True  # æŒä¹…åŒ–å·¥ä½œè¿›ç¨‹
        )
    
    def clear_cache(self):
        """æ¸…ç†ç¼“å­˜"""
        if torch.cuda.is_available():
            torch.cuda.empty_cache()
```

## ğŸ”’ é”™è¯¯å¤„ç†æ¶æ„

### å¼‚å¸¸å¤„ç†å±‚æ¬¡
```python
# åˆ†å±‚å¼‚å¸¸å¤„ç†
class SystemException(Exception):
    """ç³»ç»Ÿçº§å¼‚å¸¸"""
    pass

class DataException(SystemException):
    """æ•°æ®ç›¸å…³å¼‚å¸¸"""
    pass

class ModelException(SystemException):
    """æ¨¡å‹ç›¸å…³å¼‚å¸¸"""
    pass

class TrainingException(SystemException):
    """è®­ç»ƒç›¸å…³å¼‚å¸¸"""
    pass

# å¼‚å¸¸å¤„ç†å™¨
class ExceptionHandler:
    """å¼‚å¸¸å¤„ç†å™¨"""
    
    def handle_data_exception(self, e: DataException):
        """å¤„ç†æ•°æ®å¼‚å¸¸"""
        logging.error(f"æ•°æ®å¼‚å¸¸: {e}")
        # å°è¯•æ¢å¤æˆ–æä¾›æ›¿ä»£æ–¹æ¡ˆ
    
    def handle_model_exception(self, e: ModelException):
        """å¤„ç†æ¨¡å‹å¼‚å¸¸"""
        logging.error(f"æ¨¡å‹å¼‚å¸¸: {e}")
        # æ¨¡å‹å›é€€æˆ–é‡æ–°åˆå§‹åŒ–
    
    def handle_training_exception(self, e: TrainingException):
        """å¤„ç†è®­ç»ƒå¼‚å¸¸"""
        logging.error(f"è®­ç»ƒå¼‚å¸¸: {e}")
        # ä¿å­˜å½“å‰çŠ¶æ€ï¼Œå°è¯•æ¢å¤è®­ç»ƒ
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—æ¶æ„

### ç›‘æ§ç³»ç»Ÿ
```python
# è®­ç»ƒç›‘æ§æ¶æ„
class TrainingMonitor:
    """è®­ç»ƒç›‘æ§å™¨"""
    
    def __init__(self, config):
        self.config = config
        self.metrics_history = defaultdict(list)
        self.logger = self._setup_logger()
    
    def log_epoch_metrics(self, epoch, metrics):
        """è®°å½•epochæŒ‡æ ‡"""
        self.logger.info(f"Epoch {epoch}: {metrics}")
        for key, value in metrics.items():
            self.metrics_history[key].append(value)
    
    def plot_metrics(self):
        """ç»˜åˆ¶æŒ‡æ ‡å›¾è¡¨"""
        fig, axes = plt.subplots(2, 2, figsize=(15, 10))
        
        # æŸå¤±æ›²çº¿
        axes[0, 0].plot(self.metrics_history['train_loss'], label='Train')
        axes[0, 0].plot(self.metrics_history['val_loss'], label='Validation')
        axes[0, 0].set_title('Loss Curves')
        axes[0, 0].legend()
        
        # å‡†ç¡®ç‡æ›²çº¿
        axes[0, 1].plot(self.metrics_history['train_acc'], label='Train')
        axes[0, 1].plot(self.metrics_history['val_acc'], label='Validation')
        axes[0, 1].set_title('Accuracy Curves')
        axes[0, 1].legend()
        
        plt.tight_layout()
        plt.savefig('training_history.png')
```

## ğŸ”® å¯æ‰©å±•æ€§æ¶æ„

### æ’ä»¶ç³»ç»Ÿ
```python
# æ’ä»¶æ¶æ„
class PluginManager:
    """æ’ä»¶ç®¡ç†å™¨"""
    
    def __init__(self):
        self.plugins = {}
    
    def register_plugin(self, name, plugin_class):
        """æ³¨å†Œæ’ä»¶"""
        self.plugins[name] = plugin_class
    
    def load_plugin(self, name, *args, **kwargs):
        """åŠ è½½æ’ä»¶"""
        if name in self.plugins:
            return self.plugins[name](*args, **kwargs)
        else:
            raise ValueError(f"Plugin {name} not found")

# æ¨¡å‹æ’ä»¶ç¤ºä¾‹
class ModelPlugin:
    """æ¨¡å‹æ’ä»¶åŸºç±»"""
    
    def create_model(self, config):
        raise NotImplementedError
    
    def get_model_info(self):
        raise NotImplementedError

class ResNetPlugin(ModelPlugin):
    """ResNetæ’ä»¶"""
    
    def create_model(self, config):
        return models.resnet50(pretrained=config.PRETRAINED)
    
    def get_model_info(self):
        return {"name": "ResNet50", "params": "25.6M"}
```

## ğŸ† æ¶æ„ä¼˜åŠ¿æ€»ç»“

### 1. å¯ç»´æŠ¤æ€§
- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„èŒè´£åˆ†ç¦»
- **æ ‡å‡†åŒ–æ¥å£**: ç»Ÿä¸€çš„æ¨¡å—æ¥å£
- **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„ä»£ç æ³¨é‡Šå’Œæ–‡æ¡£

### 2. å¯æ‰©å±•æ€§
- **æ’ä»¶æ¶æ„**: æ˜“äºæ·»åŠ æ–°åŠŸèƒ½
- **é…ç½®é©±åŠ¨**: é€šè¿‡é…ç½®æ§åˆ¶è¡Œä¸º
- **å¼€é—­åŸåˆ™**: å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­

### 3. é«˜æ€§èƒ½
- **GPUä¼˜åŒ–**: å……åˆ†åˆ©ç”¨GPUåŠ é€Ÿ
- **å†…å­˜ä¼˜åŒ–**: é«˜æ•ˆçš„å†…å­˜ç®¡ç†
- **å¹¶è¡Œå¤„ç†**: å¤šè¿›ç¨‹æ•°æ®å¤„ç†

### 4. å¯é æ€§
- **å¼‚å¸¸å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶
- **çŠ¶æ€ç®¡ç†**: å¯æ¢å¤çš„è®­ç»ƒçŠ¶æ€
- **ç›‘æ§ç³»ç»Ÿ**: å®æ—¶çš„æ€§èƒ½ç›‘æ§

è¿™ä¸ªç³»ç»Ÿæ¶æ„ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œæ—¢ä¿è¯äº†åŠŸèƒ½çš„å®Œæ•´æ€§å’Œæ€§èƒ½çš„ä¼˜è¶Šæ€§ï¼Œåˆç¡®ä¿äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ï¼Œä¸ºå²©çŸ³å›¾åƒåˆ†ç±»ä»»åŠ¡æä¾›äº†ä¸€ä¸ªç¨³å®šã€é«˜æ•ˆã€å¯é çš„æŠ€æœ¯è§£å†³æ–¹æ¡ˆã€‚
