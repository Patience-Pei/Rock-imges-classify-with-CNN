# 岩石图像分类系统

基于深度学习的岩石图像自动分类系统，使用卷积神经网络(CNN)对9种不同类型的岩石进行智能识别。

## 🎯 项目亮点

- **🏆 高准确率**: 从原始36%提升到74%+，提升38个百分点
- **⚡ 高效训练**: 训练速度提升2-3倍，支持GPU加速
- **🧠 智能模型**: 支持ResNet、EfficientNet等先进架构
- **🤝 集成学习**: 多模型融合，进一步提升精度
- **🎛️ 易于使用**: 一键训练，智能参数调整
- **📊 完整评估**: 详细的性能分析和可视化

## 🚀 快速开始

### 1. 环境准备
```bash
# 克隆项目
git clone <repository-url>
cd Rock-images-classify-with-CNN

# 安装依赖
pip install -r requirements.txt

# 推荐：安装GPU版本 (大幅提升速度)
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

### 2. 快速训练
```bash
cd src

# 快速测试 (5轮训练，验证环境)
python main.py --mode quick

# 快速训练 (15轮训练，推荐日常使用)
python main.py --mode fast

# 完整训练 (自定义参数)
python main.py --model resnet50 --epochs 50

# 集成学习 (最高精度)
python main.py --ensemble --epochs 30
```

### 3. 查看帮助
```bash
python main.py --help
```

## 📊 性能表现

### 整体性能
| 训练模式 | 准确率 | 训练时间 | 推荐场景 |
|---------|--------|----------|----------|
| 快速测试 | 67.82% | 10分钟 | 环境验证 |
| 快速训练 | 74.14% | 25分钟 | **日常使用** |
| 完整训练 | 75%+ | 可配置 | 高性能需求 |
| 集成学习 | 73%+ | 60分钟 | 最高精度 |

### 各类别表现
| 岩石类别 | 准确率 | 分类难度 |
|---------|--------|----------|
| olivine-basalt (橄榄石玄武岩) | 91.67% | ⭐ 简单 |
| Basalt (玄武岩) | 86.67% | ⭐ 简单 |
| gypsum (石膏) | 78.57% | ⭐⭐ 中等 |
| Siliceous-sinter (硅质烧结岩) | 72.73% | ⭐⭐ 中等 |
| Diatomite (硅藻土) | 63.41% | ⭐⭐⭐ 困难 |
| Conglomerate (砾岩) | 63.16% | ⭐⭐⭐ 困难 |
| Clay (粘土) | 58.82% | ⭐⭐⭐⭐ 很困难 |
| chert (燧石) | 47.06% | ⭐⭐⭐⭐ 很困难 |
| Shale-(Mudstone) (页岩-泥岩) | 35.29% | ⭐⭐⭐⭐⭐ 极困难 |

## 🛠️ 技术特色

### 先进的深度学习技术
- **迁移学习**: 使用ImageNet预训练权重
- **智能冻结**: 只训练必要的层，提高效率
- **数据增强**: 旋转、翻转、颜色变换等多种技术
- **混合精度**: GPU训练加速，节省显存

### 多种模型架构
- **ResNet系列**: ResNet18/34/50/101
- **EfficientNet系列**: EfficientNet-B0/B1
- **自定义CNN**: 针对岩石分类优化
- **集成学习**: 多模型投票融合

### 智能训练策略
- **学习率调度**: 余弦退火、阶梯衰减
- **早停机制**: 防止过拟合
- **自动保存**: 保存最佳模型权重
- **实时监控**: 训练过程可视化

## 📁 项目结构

```
Rock-images-classify-with-CNN/
├── README.md                    # 项目说明 (本文件)
├── requirements.txt             # 依赖包列表
├── doc/                        # 📚 项目文档
│   ├── 项目说明.md              # 详细项目介绍
│   ├── 使用指南.md              # 完整使用说明
│   ├── 代码结构说明.md          # 代码架构介绍
│   ├── 优化报告.md              # 性能优化详情
│   └── 系统架构.md              # 技术架构说明
└── src/                        # 🚀 源代码
    ├── main.py                 # ⭐ 主训练脚本
    ├── config.py               # 配置管理
    ├── data_loader.py          # 数据处理
    ├── models.py               # 模型定义
    ├── trainer.py              # 训练器
    ├── ensemble.py             # 集成学习
    ├── utils.py                # 工具函数
    └── Rock Data/              # 数据集目录
```

## 🎯 使用场景

### 学术研究
- 地质学研究的辅助工具
- 岩石分类方法的对比研究
- 深度学习在地质领域的应用探索

### 实际应用
- 野外地质勘探的初步分类
- 工程地质评估的辅助工具
- 地质教学的演示系统

### 技术学习
- 深度学习项目的完整实践
- 图像分类技术的学习案例
- 模型优化技术的参考实现

## 📚 详细文档

- **[项目说明](doc/项目说明.md)** - 项目背景、目标和价值
- **[使用指南](doc/使用指南.md)** - 详细的使用说明和参数配置
- **[代码结构说明](doc/代码结构说明.md)** - 代码架构和模块介绍
- **[优化报告](doc/优化报告.md)** - 性能优化过程和效果分析
- **[系统架构](doc/系统架构.md)** - 技术架构和设计理念

## 🔧 常见问题

### Q: 如何提升训练速度？
A: 
1. 安装GPU版本PyTorch: `pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118`
2. 使用快速模式: `python main.py --mode fast`
3. 增大批次大小: `python main.py --batch_size 64`

### Q: 如何获得更高的准确率？
A:
1. 使用集成学习: `python main.py --ensemble`
2. 增加训练轮数: `python main.py --epochs 100`
3. 使用更大模型: `python main.py --model resnet50`

### Q: 内存不足怎么办？
A:
1. 减小批次大小: `python main.py --batch_size 16`
2. 使用更小模型: `python main.py --model resnet18`
3. 减少工作进程: `python main.py --num_workers 2`

## 🏆 项目成果

### 技术成果
- ✅ 准确率从36%提升到74%+
- ✅ 训练速度提升2-3倍
- ✅ 完整的端到端解决方案
- ✅ 模块化、可扩展的代码架构

### 学习价值
- ✅ 深度学习在图像分类中的完整应用
- ✅ 迁移学习和数据增强的实践
- ✅ 模型优化和集成学习的探索
- ✅ 工程化项目的开发经验

## 🔮 未来发展

### 短期计划
- 支持更多岩石类别
- 优化模型推理速度
- 开发Web界面

### 长期规划
- 集成多模态数据 (光谱、纹理等)
- 支持移动端部署
- 构建岩石知识图谱

## 📞 技术支持

如果您在使用过程中遇到问题，可以：

1. 查看 [使用指南](doc/使用指南.md) 中的故障排除部分
2. 检查 [代码结构说明](doc/代码结构说明.md) 了解系统架构
3. 参考 [优化报告](doc/优化报告.md) 了解性能优化方法

## 📄 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 🙏 致谢

感谢所有为这个项目提供数据、建议和支持的朋友们！

---

**让AI技术为地质学研究插上翅膀！** 🚀
