# 岩石图像分类项目说明

## 项目概述

本项目是一个基于深度学习的岩石图像分类系统，使用卷积神经网络(CNN)对9种不同类型的岩石进行自动分类。主要目标是实现岩石图像的自动分类，准确率达到80%以上。目前最高准确率达到77%。代码目录中包含训练好的模型，按指引运行测试脚本即可验证结果。项目文件结构详见下述目录图。

## 项目目标

- **主要目标**: 实现岩石图像的自动分类，准确率达到80%以上
- **当前成果**: 准确率已达到77%，接近目标
- **技术路线**: 使用迁移学习、数据增强、集成学习等技术

## 项目目录结构

```
Rock-images-classify-with-CNN/
├── requirements.txt             # 项目依赖包列表
├── doc/                         # 项目文档目录
│   ├── 使用指南.md              # 详细使用说明
│   ├── 代码结构说明.md          # 代码架构介绍
│   └── result/                  # 分类报告和结果图表
├── src/                         # 源代码目录
│   ├── main.py                  # 主训练脚本
|   ├── test.py                  # 测试已训练模型脚本
│   ├── config.py                # 配置管理模块
│   ├── data_loader.py           # 数据加载和预处理
│   ├── models.py                # 模型定义模块
│   ├── trainer.py               # 训练器模块
│   ├── ensemble.py              # 集成学习模块
│   ├── utils.py                 # 工具函数模块
│   ├── Rock Data/               # 岩石图像数据集
│   │   ├── train/               # 训练集 (3,687张图片)
│   │   ├── valid/               # 验证集 (351张图片)
│   │   └── test/                # 测试集 (174张图片)
│   ├── models/                  # 模型保存目录
│   ├── results/                 # 训练结果目录
│   └── test_models/             # 待测试模型目录
```

## 数据集信息

### 岩石类别 (9类)
1. **Basalt** (玄武岩) - 火成岩
2. **Clay** (粘土) - 沉积岩
3. **Conglomerate** (砾岩) - 沉积岩
4. **Diatomite** (硅藻土) - 沉积岩
5. **Shale-(Mudstone)** (页岩-泥岩) - 沉积岩
6. **Siliceous-sinter** (硅质烧结岩) - 化学沉积岩
7. **chert** (燧石) - 沉积岩
8. **gypsum** (石膏) - 蒸发岩
9. **olivine-basalt** (橄榄石玄武岩) - 火成岩

### 数据分布
- **训练集**: 3,687张图片
- **验证集**: 351张图片
- **测试集**: 174张图片
- **总计**: 4,212张图片
- **图像格式**: JPG

## 技术特色

### 1. 先进的模型架构
- **迁移学习**: 使用ImageNet预训练的ResNet、EfficientNet等
- **智能冻结**: 只训练必要的层，提高训练效率
- **多模型支持**: ResNet18/34/50/101, EfficientNet, 自定义CNN

### 2. 智能数据处理
- **数据增强**: 旋转、翻转、颜色变换、随机裁剪等
- **自适应预处理**: 根据模型要求自动调整
- **批量优化**: 高效的数据加载和预处理流程

### 3. 高效训练策略
- **学习率调度**: 余弦退火、阶梯衰减等策略
- **早停机制**: 防止过拟合，节省训练时间
- **混合精度**: 加速训练，节省显存
- **集成学习**: 多模型投票提升准确率

### 4. 完整评估体系
- **多维度评估**: 准确率、精确率、召回率、F1分数
- **可视化分析**: 混淆矩阵、训练曲线、类别性能图
- **详细报告**: 自动生成分类报告和性能分析

## 项目成果

### 技术成果
- 最高准确率达到77%
- 完整的端到端解决方案
- 模块化、可扩展的代码架构

### 学习成果
- 掌握深度学习在图像分类中的应用
- 理解迁移学习和数据增强技术
- 获得项目工程化经验